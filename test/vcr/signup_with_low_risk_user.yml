---
http_interactions:
- request:
    method: post
    uri: https://api.castle.io/v1/filter
    body:
      encoding: UTF-8
      string: '{"type":"$registration","status":"$attempted","request_token":"YGk4KzI0NRcnUwE6BDMiGFkGGhMLFDAIURFZNyUiLAIVEigvr1BTYkfSK7LkyGU5yoy5j5Yg9TU1lkf4cTNe73RdMNYka0CrVr22-Kc77tZpDVTFZX-i_y40XkQWOdy2HkI3lx1Zcc5fCH7TPFk9kh9MMYgZA36yH0w7l1F1P5hRdw3bKRhvyy4Ja6RGEX66AUgyniZdPLAYTHHOQg9wyEcYdrA5bBO3XRgykhpdfrwUWzWUWBgWnhBcMp4CSx2TA1cznl4Jb8hfCHDORw9s1UAKaNsiWTiaA1FxzkIPcMhHVFjPSA9smRWzXm95Dm3KQAxomhScSspeCXHKSA9u11EJZMtBAm7LUXkTVHk469q0koMwcetfJvKeufuaO6m2O9pBk46SNHhyOFL2NE0slAFdcbceVjqUHyxbnh8VC6gxOF77cThe-3E4XvtxOF77cThe-3E4XvtxOF77cThe-3E4HrsxeB67cThe-3E4XvtxOF77MThe-3E4XvtxOF77jmA","params":{"email":"user@example.com"},"context":{"ip":"127.0.0.1","headers":{"Version":"HTTP/1.1","Host":"127.0.0.1:58947","Connection":"keep-alive","Content-Length":"668","Cache-Control":"max-age=0","Sec-Ch-Ua":"\"HeadlessChrome\";v=\"113\",
        \"Chromium\";v=\"113\", \"Not-A.Brand\";v=\"24\"","Sec-Ch-Ua-Mobile":"?0","Sec-Ch-Ua-Platform":"\"macOS\"","Upgrade-Insecure-Requests":"1","Origin":"http://127.0.0.1:58947","User-Agent":"Mozilla/5.0
        (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko)
        HeadlessChrome/113.0.5672.126 Safari/537.36","Accept":"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7","Sec-Fetch-Site":"same-origin","Sec-Fetch-Mode":"navigate","Sec-Fetch-User":"?1","Sec-Fetch-Dest":"document","Referer":"http://127.0.0.1:58947/signup","Accept-Encoding":"gzip,
        deflate, br","Cookie":true,"Remote-Addr":"127.0.0.1"}},"timestamp":"2023-06-04T15:12:51.715Z","sent_at":"2023-06-04T15:12:51.715Z"}'
    headers:
      Content-Type:
      - application/json
      Accept-Encoding:
      - gzip;q=1.0,deflate;q=0.6,identity;q=0.3
      Accept:
      - "*/*"
      User-Agent:
      - Ruby
      Authorization:
      - Basic <BASIC_AUTH_ENCODED_CASTLE_API_SECRET>
  response:
    status:
      code: 201
      message: Created
    headers:
      Date:
      - Sun, 04 Jun 2023 15:12:29 GMT
      Content-Type:
      - application/json
      Transfer-Encoding:
      - chunked
      Connection:
      - keep-alive
      X-Ratelimit-Limit:
      - '10'
      X-Ratelimit-Remaining:
      - '9'
      X-Ratelimit-Reset:
      - '1'
      Etag:
      - W/"b332e74b9c4577f4a1ed7fd466450eb7"
      Cache-Control:
      - max-age=0, private, must-revalidate
      X-Request-Id:
      - 5ac5b1cc-b76f-48e7-9bb3-8a0c3f9c0338
      Server:
      - castle.io
    body:
      encoding: UTF-8
      string: '{"risk":0.0,"scores":{"account_abuse":{"score":0.0},"account_takeover":{"score":0.0},"bot":{"score":0.0}},"signals":{"bot_behavior":{},"headless_browser":{}},"policy":{"action":"allow","id":"b7f26fb8-1e12-414d-a44e-7097c5c112b4","revision_id":"","name":"Default"},"device":{"token":null,"fingerprint":"kA4R2QSdQXOYhceWw_9JoA"}}'
  recorded_at: Sun, 04 Jun 2023 15:12:52 GMT
- request:
    method: post
    uri: https://api.castle.io/v1/risk
    body:
      encoding: UTF-8
      string: '{"type":"$registration","status":"$succeeded","request_token":"YGk4KzI0NRcnUwE6BDMiGFkGGhMLFDAIURFZNyUiLAIVEigvr1BTYkfSK7LkyGU5yoy5j5Yg9TU1lkf4cTNe73RdMNYka0CrVr22-Kc77tZpDVTFZX-i_y40XkQWOdy2HkI3lx1Zcc5fCH7TPFk9kh9MMYgZA36yH0w7l1F1P5hRdw3bKRhvyy4Ja6RGEX66AUgyniZdPLAYTHHOQg9wyEcYdrA5bBO3XRgykhpdfrwUWzWUWBgWnhBcMp4CSx2TA1cznl4Jb8hfCHDORw9s1UAKaNsiWTiaA1FxzkIPcMhHVFjPSA9smRWzXm95Dm3KQAxomhScSspeCXHKSA9u11EJZMtBAm7LUXkTVHk469q0koMwcetfJvKeufuaO6m2O9pBk46SNHhyOFL2NE0slAFdcbceVjqUHyxbnh8VC6gxOF77cThe-3E4XvtxOF77cThe-3E4XvtxOF77cThe-3E4HrsxeB67cThe-3E4XvtxOF77MThe-3E4XvtxOF77jmA","user":{"id":"1046959424","email":"user@example.com"},"context":{"ip":"127.0.0.1","headers":{"Version":"HTTP/1.1","Host":"127.0.0.1:58947","Connection":"keep-alive","Content-Length":"668","Cache-Control":"max-age=0","Sec-Ch-Ua":"\"HeadlessChrome\";v=\"113\",
        \"Chromium\";v=\"113\", \"Not-A.Brand\";v=\"24\"","Sec-Ch-Ua-Mobile":"?0","Sec-Ch-Ua-Platform":"\"macOS\"","Upgrade-Insecure-Requests":"1","Origin":"http://127.0.0.1:58947","User-Agent":"Mozilla/5.0
        (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko)
        HeadlessChrome/113.0.5672.126 Safari/537.36","Accept":"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7","Sec-Fetch-Site":"same-origin","Sec-Fetch-Mode":"navigate","Sec-Fetch-User":"?1","Sec-Fetch-Dest":"document","Referer":"http://127.0.0.1:58947/signup","Accept-Encoding":"gzip,
        deflate, br","Cookie":true,"Remote-Addr":"127.0.0.1"}},"timestamp":"2023-06-04T15:12:52.623Z","sent_at":"2023-06-04T15:12:52.624Z"}'
    headers:
      Content-Type:
      - application/json
      Accept-Encoding:
      - gzip;q=1.0,deflate;q=0.6,identity;q=0.3
      Accept:
      - "*/*"
      User-Agent:
      - Ruby
      Authorization:
      - Basic <BASIC_AUTH_ENCODED_CASTLE_API_SECRET>
  response:
    status:
      code: 201
      message: Created
    headers:
      Date:
      - Sun, 04 Jun 2023 15:12:29 GMT
      Content-Type:
      - application/json
      Transfer-Encoding:
      - chunked
      Connection:
      - keep-alive
      X-Ratelimit-Limit:
      - '10'
      X-Ratelimit-Remaining:
      - '8'
      X-Ratelimit-Reset:
      - '1'
      Etag:
      - W/"66ae4a1f9ecc2a3b6197bff77f728a15"
      Cache-Control:
      - max-age=0, private, must-revalidate
      X-Request-Id:
      - 6cf2baef-b204-4b32-808d-76d5d6be5ec5
      Server:
      - castle.io
    body:
      encoding: UTF-8
      string: '{"risk":0.0,"scores":{"account_abuse":{"score":0.0},"account_takeover":{"score":0.0},"bot":{"score":0.0}},"signals":{"bot_behavior":{},"headless_browser":{}},"policy":{"action":"allow","id":"b7f26fb8-1e12-414d-a44e-7097c5c112b4","revision_id":"","name":"Default"},"device":{"token":"eyJhbGciOiJIUzI1NiJ9.eyJ0b2tlbiI6InRxME9MMnNRSTlnM2tqY1lKOUpmVlh5QWZHUFIiLCJxdWFsaWZpZXIiOiJBUUlEQ2pJeE5UVTJOalkzT1RFIiwiYW5vbnltb3VzIjpmYWxzZSwidmVyc2lvbiI6MC4zfQ.R9lsK-tNK82dVFISa2C2n-tLJ_L3PVdoaHu-0iEKq5E","fingerprint":"kA4R2QSdQXOYhceWw_9JoA"}}'
  recorded_at: Sun, 04 Jun 2023 15:12:53 GMT
recorded_with: VCR 6.1.0
